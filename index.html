<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تقرير تتبع جودة التعليم والتعلم</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root {
            --primary: #2c5aa0;
            --primary-light: #4a7bc8;
            --secondary: #4caf50;
            --accent: #ff9800;
            --light: #f5f7fa;
            --dark: #333;
            --gray: #6c757d;
            --danger: #dc3545;
            --success: #28a745;
            --warning: #ffc107;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background-color: #f0f2f5;
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .quality-report-section {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .quality-report-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light);
        }

        .quality-report-title {
            font-size: 1.8rem;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .quality-report-subtitle {
            font-size: 1.2rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
        }

        .report-table th {
            background-color: var(--primary);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
        }

        .report-table td {
            padding: 10px 8px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .report-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .report-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--light);
        }

        .report-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }

        .report-textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            min-height: 80px;
        }

        .report-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
        }

        .report-section-title {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 1rem;
            font-weight: 700;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: border 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            text-align: center;
        }

        .btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: #3d8b40;
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-warning {
            background-color: var(--warning);
            color: var(--dark);
        }

        .btn-warning:hover {
            background-color: #e0a800;
        }

        .report-notes {
            font-style: italic;
            color: var(--gray);
            margin-top: 1rem;
            text-align: center;
        }

        @media (max-width: 768px) {
            .report-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .report-table {
                font-size: 0.8rem;
            }
            
            .report-table th,
            .report-table td {
                padding: 8px 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="quality-report-section">
            <div class="quality-report-header">
                <h2 class="quality-report-title">تقرير متابعة جودة التعليم والتعلم للقيادة العليا والوسطى</h2>
                <p class="quality-report-subtitle" id="schoolNameHeader">لمدرسة ــــــــــــــــــــــــــــــــــــ</p>
                <p class="quality-report-subtitle" id="reportMonthHeader">شهر ____________</p>
                <p class="quality-report-subtitle" id="academicYearHeader">العام الدراسي 2025 / 2026م</p>
                <p class="quality-report-subtitle">إعداد المدير/ة المساعد/ة /يعتمد، مدير/ة المدرسة</p>
            </div>

            <!-- أولاً: متابعة تسليم القيادة الوسطى -->
            <div class="report-section">
                <h3 class="report-section-title">أولاً: متابعة تسليم القيادة الوسطى (الزيارات/محاضر الاجتماعات /الخطة الأسبوعية) للمواد الدراسية الى المدير/ة المساعد/ة في المدرسة</h3>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>القسم</th>
                            <th>عدد استمارات الزيارات الصفية التي نفذت من قبل المعلم الأول أو المنسق خلال الشهر</th>
                            <th>يوجد محضر اجتماع المعلم الأول أو المنسق مع المعلمين</th>
                            <th>توجد خطة أسبوعية للمعلم الأول أو المنسق</th>
                            <th>أسباب عدم التسليم</th>
                        </tr>
                    </thead>
                    <tbody id="middleLeadershipReportTable">
                        <!-- سيتم ملؤها بالبيانات -->
                    </tbody>
                </table>
                <p class="report-notes">ملاحظات عامة: يتم التنسيق مع القيادة الوسطى لتنفيذ الزيارات الصفية بحسب ما يتناسب مع ظروف الجداول والنصاب المسند لهم.</p>
            </div>

            <!-- ثانياً: عدد الزيارات -->
            <div class="report-section">
                <h3 class="report-section-title">ثانياً: عدد الزيارات التي نُفذت خلال شهر ____________ من قبل:</h3>
                <div class="form-group">
                    <label for="seniorLeadershipVisits">1- القيادة العليا =</label>
                    <input type="number" id="seniorLeadershipVisits" class="report-input" min="0">
                </div>
                <div class="form-group">
                    <label for="middleLeadershipVisits">2- القيادة الوسطى =</label>
                    <input type="number" id="middleLeadershipVisits" class="report-input" min="0">
                </div>
            </div>

            <!-- ثالثاً: أسماء المعلمين المُزارين -->
            <div class="report-section">
                <h3 class="report-section-title">ثالثاً: بيان أسماء المعلمين المُزارين من قبل القيادة العليا والوسطى خلال شهر ____________</h3>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>م</th>
                            <th>اسم المعلم</th>
                            <th>القسم</th>
                            <th>تاريخ الزيارة</th>
                            <th>تقييم الزيارة</th>
                            <th>اسم الزائر</th>
                        </tr>
                    </thead>
                    <tbody id="teacherVisitsReportTable">
                        <!-- سيتم ملؤها بالبيانات -->
                    </tbody>
                </table>
            </div>

            <!-- رابعاً: عدد الزيارات الصفية وتقييم الأداء الصفي -->
            <div class="report-section">
                <h3 class="report-section-title">رابعاً: عدد الزيارات الصفية وتقييم الأداء الصفي</h3>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>م</th>
                            <th>الأقسام الأكاديمية</th>
                            <th>مجموع عدد الزيارات للقسم</th>
                            <th>يفوق التوقعات بكثير</th>
                            <th>يفوق التوقعات</th>
                            <th>يفي بالتوقعات</th>
                            <th>يفي بالتوقعات جزئياً</th>
                        </tr>
                    </thead>
                    <tbody id="performanceReportTable">
                        <!-- سيتم ملؤها بالبيانات -->
                    </tbody>
                </table>
                <div class="form-group">
                    <label for="totalClassVisits">مجموع عدد الزيارات الصفية للقيادة العليا والوسطى</label>
                    <input type="number" id="totalClassVisits" class="report-input" min="0">
                </div>
                <p class="report-notes">رسم بياني يوضح مجموع عدد الزيارات الصفية للقيادة العليا والوسطى</p>
            </div>

            <!-- سادساً: المعلمين المتميزين والأولى بالرعاية -->
            <div class="report-section">
                <h3 class="report-section-title">سادساً: حصر أسماء المعلمين المتميزين في الأقسام الأكاديمية</h3>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>الرقم</th>
                            <th>اسم المعلم</th>
                            <th>التقدير</th>
                            <th>المبررات</th>
                            <th>القسم الأكاديمي</th>
                        </tr>
                    </thead>
                    <tbody id="distinguishedTeachersReportTable">
                        <!-- سيتم ملؤها بالبيانات -->
                    </tbody>
                </table>

                <h4 style="margin-top: 2rem; color: var(--primary);">حصر أسماء المعلمين الأولى بالرعاية في الأقسام الأكاديمية</h4>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>الرقم</th>
                            <th>اسم المعلم</th>
                            <th>التقدير</th>
                            <th>المبررات</th>
                            <th>القسم الأكاديمي</th>
                        </tr>
                    </thead>
                    <tbody id="teachersNeedCareReportTable">
                        <!-- سيتم ملؤها بالبيانات -->
                    </tbody>
                </table>
            </div>

            <!-- سابعاً: التقرير النوعي -->
            <div class="report-section">
                <h3 class="report-section-title">سابعاً: التقرير النوعي</h3>
                <h4>جوانب القوة والتطوير لأداء المعلمين خلال الزيارات الصفية في الأقسام الأكاديمية</h4>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>الأقسام الأكاديمية</th>
                            <th>جوانب القوة</th>
                            <th>جوانب بحاجة إلى تطوير</th>
                        </tr>
                    </thead>
                    <tbody id="qualityReportTable">
                        <!-- سيتم ملؤها بالبيانات -->
                    </tbody>
                </table>
            </div>

            <!-- أزرار التحميل -->
            <div class="report-actions">
                <button class="btn btn-success" id="downloadWordReport">
                    <i class="fas fa-file-word"></i> تحميل كملف Word
                </button>
                <button class="btn btn-danger" id="downloadPdfReport">
                    <i class="fas fa-file-pdf"></i> تحميل كملف PDF
                </button>
                <button class="btn btn-secondary" id="saveQualityReport">
                    <i class="fas fa-save"></i> حفظ التقرير
                </button>
                <button class="btn btn-warning" id="loadSampleData">
                    <i class="fas fa-download"></i> تحميل بيانات نموذجية
                </button>
            </div>
        </div>
    </div>

    <script>
        // بيانات التقرير
        const qualityReportData = {
            schoolName: '',
            reportMonth: '',
            academicYear: '2025 / 2026م',
            middleLeadership: [],
            seniorLeadershipVisits: 0,
            middleLeadershipVisits: 0,
            teacherVisits: [],
            performance: [],
            distinguishedTeachers: [],
            teachersNeedCare: [],
            qualityReport: [],
            totalClassVisits: 0
        };

        // بيانات نموذجية للاختبار
        const sampleData = {
            seniorLeadershipVisits: 15,
            middleLeadershipVisits: 25,
            totalClassVisits: 40,
            middleLeadership: [
                { department: 'معلم أول / منسق اللغة العربية', visits: 5, meeting: 'نعم', plan: 'نعم', reasons: '' },
                { department: 'معلم أول/منسق رياضيات وعلوم', visits: 6, meeting: 'نعم', plan: 'نعم', reasons: '' },
                { department: 'معلم اول/منسق اللغة الإنجليزية', visits: 4, meeting: 'نعم', plan: 'لا', reasons: 'انشغال المنسق' },
                { department: 'معلم أول/منسق تربية اسلامية', visits: 5, meeting: 'نعم', plan: 'نعم', reasons: '' },
                { department: 'معلم اول/منسق المواد الاجتماعية', visits: 3, meeting: 'لا', plan: 'نعم', reasons: 'تأخر في التسليم' },
                { department: 'معلم أول/منسق نظام فصل', visits: 4, meeting: 'نعم', plan: 'نعم', reasons: '' },
                { department: 'منسق المواد الإثرائية', visits: 2, meeting: 'نعم', plan: 'نعم', reasons: '' },
                { department: 'منسق التربية الرياضية', visits: 3, meeting: 'نعم', plan: 'نعم', reasons: '' }
            ],
            teacherVisits: [
                { teacher: 'أحمد محمد', department: 'اللغة العربية', date: '2025-03-15', evaluation: 'ممتاز', visitor: 'مدير المدرسة' },
                { teacher: 'فاطمة عبدالله', department: 'الرياضيات', date: '2025-03-18', evaluation: 'جيد جداً', visitor: 'نائب المدير' },
                { teacher: 'خالد إبراهيم', department: 'العلوم', date: '2025-03-20', evaluation: 'ممتاز', visitor: 'مدير المدرسة' },
                { teacher: 'سارة علي', department: 'اللغة الإنجليزية', date: '2025-03-22', evaluation: 'جيد', visitor: 'نائب المدير' },
                { teacher: 'محمد حسن', department: 'التربية الإسلامية', date: '2025-03-25', evaluation: 'جيد جداً', visitor: 'مدير المدرسة' }
            ],
            performance: [
                { department: 'قسم الرياضيات', total: 8, excellent: 3, veryGood: 3, good: 2, fair: 0 },
                { department: 'قسم العلوم', total: 7, excellent: 2, veryGood: 3, good: 2, fair: 0 },
                { department: 'قسم اللغة العربية', total: 9, excellent: 4, veryGood: 3, good: 2, fair: 0 },
                { department: 'قسم اللغة الانجليزية', total: 6, excellent: 2, veryGood: 2, good: 2, fair: 0 },
                { department: 'قسم التربية الاسلامية', total: 5, excellent: 2, veryGood: 2, good: 1, fair: 0 },
                { department: 'قسم المواد الاجتماعية', total: 4, excellent: 1, veryGood: 2, good: 1, fair: 0 },
                { department: 'قسم المواد الاثرائية', total: 3, excellent: 1, veryGood: 1, good: 1, fair: 0 },
                { department: 'قسم التربية الرياضية', total: 2, excellent: 1, veryGood: 1, good: 0, fair: 0 },
                { department: 'قسم نظام فصل', total: 2, excellent: 1, veryGood: 1, good: 0, fair: 0 }
            ],
            distinguishedTeachers: [
                { name: 'أحمد محمد', evaluation: 'متميز', reasons: 'تفوق في استخدام استراتيجيات التعلم النشط', department: 'اللغة العربية' },
                { name: 'فاطمة عبدالله', evaluation: 'متميز', reasons: 'إبداع في تصميم الأنشطة الصفية', department: 'الرياضيات' },
                { name: 'خالد إبراهيم', evaluation: 'متميز', reasons: 'تميز في إدارة الصف وتنظيم الوقت', department: 'العلوم' }
            ],
            teachersNeedCare: [
                { name: 'سارة علي', evaluation: 'بحاجة لتطوير', reasons: 'ضعف في إدارة الصف', department: 'اللغة الإنجليزية' },
                { name: 'محمد حسن', evaluation: 'بحاجة لدعم', reasons: 'صعوبة في استخدام التقنية', department: 'التربية الإسلامية' }
            ],
            qualityReport: [
                { department: 'الرياضيات والعلوم', strengths: 'تفعيل استراتيجيات التعلم النشط - استخدام الوسائل التعليمية', improvements: 'تحسين مهارات التقويم - تنويع أساليب التدريس' },
                { department: 'اللغة العربية', strengths: 'تميز في مهارات التواصل - إتقان المادة العلمية', improvements: 'تحسين إدارة الوقت - تنويع الأنشطة' },
                { department: 'اللغة الانجليزية', strengths: 'استخدام اللغة في المواقف الحياتية - تفعيل المحادثة', improvements: 'تحسين نطق بعض الحروف - زيادة الثقة بالنفس' },
                { department: 'التربية الإسلامية', strengths: 'الإلمام بالمادة العلمية - الالتزام بالقيم', improvements: 'تنويع أساليب العرض - استخدام الوسائل التقنية' },
                { department: 'المواد الاجتماعية', strengths: 'ربط المادة بالواقع - استخدام الخرائط', improvements: 'تحسين مهارات العرض - تفعيل التعلم التعاوني' },
                { department: 'المواد الاثرائية', strengths: 'تنوع الأنشطة - تشجيع الإبداع', improvements: 'تحسين التخطيط - توثيق المنجزات' },
                { department: 'التربية الرياضية', strengths: 'تنظيم الحصص - الاهتمام بالسلامة', improvements: 'تنويع الألعاب - تفعيل المنافسات' },
                { department: 'نظام الفصل', strengths: 'تنظيم البيئة الصفية - متابعة الطلاب', improvements: 'تحسين التواصل مع أولياء الأمور - توثيق المتابعة' }
            ]
        };

        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', function() {
            // إعداد قسم تقرير الجودة
            setupQualityReport();
            
            // إعداد أزرار التحميل
            document.getElementById('downloadWordReport').addEventListener('click', downloadWordReport);
            document.getElementById('downloadPdfReport').addEventListener('click', downloadPdfReport);
            document.getElementById('saveQualityReport').addEventListener('click', saveQualityReport);
            document.getElementById('loadSampleData').addEventListener('click', loadSampleData);

            // إعداد حقول الإدخال
            document.getElementById('seniorLeadershipVisits').addEventListener('change', updateQualityReport);
            document.getElementById('middleLeadershipVisits').addEventListener('change', updateQualityReport);
            document.getElementById('totalClassVisits').addEventListener('change', updateQualityReport);
        });

        // إعداد قسم تقرير الجودة
        function setupQualityReport() {
            // تحديث اسم المدرسة في التقرير
            document.getElementById('schoolNameHeader').textContent = `لمدرسة ${qualityReportData.schoolName || 'ــــــــــــــــــــــــــــــــــ'}`;
            
            // تحديث الشهر الحالي
            const currentMonth = new Date().toLocaleDateString('ar-EG', { month: 'long' });
            document.getElementById('reportMonthHeader').textContent = `شهر ${currentMonth}`;
            document.querySelectorAll('.report-section-title').forEach(title => {
                if (title.textContent.includes('شهر')) {
                    title.textContent = title.textContent.replace('____________', currentMonth);
                }
            });

            // تحميل البيانات المحفوظة
            loadQualityReportData();

            // تعبئة البيانات في النموذج
            document.getElementById('seniorLeadershipVisits').value = qualityReportData.seniorLeadershipVisits;
            document.getElementById('middleLeadershipVisits').value = qualityReportData.middleLeadershipVisits;
            document.getElementById('totalClassVisits').value = qualityReportData.totalClassVisits || 0;

            // تعبئة الجداول
            renderMiddleLeadershipReportTable();
            renderTeacherVisitsReportTable();
            renderPerformanceReportTable();
            renderDistinguishedTeachersReportTable();
            renderTeachersNeedCareReportTable();
            renderQualityReportTable();
        }

        // تحميل بيانات تقرير الجودة
        function loadQualityReportData() {
            const savedReport = localStorage.getItem('qualityReportData');
            if (savedReport) {
                const reportData = JSON.parse(savedReport);
                Object.assign(qualityReportData, reportData);
            }
        }

        // تحديث بيانات تقرير الجودة
        function updateQualityReport() {
            qualityReportData.seniorLeadershipVisits = parseInt(document.getElementById('seniorLeadershipVisits').value) || 0;
            qualityReportData.middleLeadershipVisits = parseInt(document.getElementById('middleLeadershipVisits').value) || 0;
            qualityReportData.totalClassVisits = parseInt(document.getElementById('totalClassVisits').value) || 0;
        }

        // حفظ تقرير الجودة
        function saveQualityReport() {
            updateQualityReport();
            localStorage.setItem('qualityReportData', JSON.stringify(qualityReportData));
            alert('تم حفظ تقرير الجودة بنجاح');
        }

        // تحميل بيانات نموذجية
        function loadSampleData() {
            if (confirm('هل تريد تحميل البيانات النموذجية؟ سيتم استبدال جميع البيانات الحالية.')) {
                Object.assign(qualityReportData, JSON.parse(JSON.stringify(sampleData)));
                
                // تحديث الحقول
                document.getElementById('seniorLeadershipVisits').value = qualityReportData.seniorLeadershipVisits;
                document.getElementById('middleLeadershipVisits').value = qualityReportData.middleLeadershipVisits;
                document.getElementById('totalClassVisits').value = qualityReportData.totalClassVisits;
                
                // إعادة تعبئة الجداول
                renderMiddleLeadershipReportTable();
                renderTeacherVisitsReportTable();
                renderPerformanceReportTable();
                renderDistinguishedTeachersReportTable();
                renderTeachersNeedCareReportTable();
                renderQualityReportTable();
                
                alert('تم تحميل البيانات النموذجية بنجاح');
            }
        }

        // عرض جدول القيادة الوسطى في التقرير
        function renderMiddleLeadershipReportTable() {
            const table = document.getElementById('middleLeadershipReportTable');
            table.innerHTML = '';

            const departments = [
                'معلم أول / منسق اللغة العربية',
                'معلم أول/منسق رياضيات وعلوم',
                'معلم اول/منسق اللغة الإنجليزية',
                'معلم أول/منسق تربية اسلامية',
                'معلم اول/منسق المواد الاجتماعية',
                'معلم أول/منسق نظام فصل',
                'منسق المواد الإثرائية',
                'منسق التربية الرياضية'
            ];

            departments.forEach(dept => {
                const row = document.createElement('tr');
                const existingData = qualityReportData.middleLeadership.find(item => item.department === dept) || {};
                
                row.innerHTML = `
                    <td>${dept}</td>
                    <td><input type="number" class="report-input" value="${existingData.visits || ''}" min="0" data-department="${dept}" data-field="visits"></td>
                    <td>
                        <select class="report-input" data-department="${dept}" data-field="meeting">
                            <option value="نعم" ${existingData.meeting === 'نعم' ? 'selected' : ''}>نعم</option>
                            <option value="لا" ${existingData.meeting === 'لا' ? 'selected' : ''}>لا</option>
                        </select>
                    </td>
                    <td>
                        <select class="report-input" data-department="${dept}" data-field="plan">
                            <option value="نعم" ${existingData.plan === 'نعم' ? 'selected' : ''}>نعم</option>
                            <option value="لا" ${existingData.plan === 'لا' ? 'selected' : ''}>لا</option>
                        </select>
                    </td>
                    <td><input type="text" class="report-input" value="${existingData.reasons || ''}" data-department="${dept}" data-field="reasons"></td>
                `;
                table.appendChild(row);
            });

            // إضافة معالجي الأحداث
            table.querySelectorAll('input, select').forEach(element => {
                element.addEventListener('change', function() {
                    const department = this.getAttribute('data-department');
                    const field = this.getAttribute('data-field');
                    const value = this.value;

                    let deptData = qualityReportData.middleLeadership.find(item => item.department === department);
                    if (!deptData) {
                        deptData = { department: department };
                        qualityReportData.middleLeadership.push(deptData);
                    }
                    deptData[field] = value;
                });
            });
        }

        // عرض جدول المعلمين المُزارين في التقرير
        function renderTeacherVisitsReportTable() {
            const table = document.getElementById('teacherVisitsReportTable');
            table.innerHTML = '';

            qualityReportData.teacherVisits.forEach((visit, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><input type="text" class="report-input" value="${visit.teacher || ''}" data-index="${index}" data-field="teacher"></td>
                    <td><input type="text" class="report-input" value="${visit.department || ''}" data-index="${index}" data-field="department"></td>
                    <td><input type="date" class="report-input" value="${visit.date || ''}" data-index="${index}" data-field="date"></td>
                    <td>
                        <select class="report-input" data-index="${index}" data-field="evaluation">
                            <option value="ممتاز" ${visit.evaluation === 'ممتاز' ? 'selected' : ''}>ممتاز</option>
                            <option value="جيد جداً" ${visit.evaluation === 'جيد جداً' ? 'selected' : ''}>جيد جداً</option>
                            <option value="جيد" ${visit.evaluation === 'جيد' ? 'selected' : ''}>جيد</option>
                            <option value="مقبول" ${visit.evaluation === 'مقبول' ? 'selected' : ''}>مقبول</option>
                            <option value="ضعيف" ${visit.evaluation === 'ضعيف' ? 'selected' : ''}>ضعيف</option>
                        </select>
                    </td>
                    <td><input type="text" class="report-input" value="${visit.visitor || ''}" data-index="${index}" data-field="visitor"></td>
                `;
                table.appendChild(row);
            });

            // إضافة معالجي الأحداث
            table.querySelectorAll('input, select').forEach(element => {
                element.addEventListener('change', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    const field = this.getAttribute('data-field');
                    const value = this.value;

                    if (!qualityReportData.teacherVisits[index]) {
                        qualityReportData.teacherVisits[index] = {};
                    }
                    qualityReportData.teacherVisits[index][field] = value;
                });
            });

            // زر إضافة زيارة جديدة
            const addRow = document.createElement('tr');
            addRow.innerHTML = `
                <td colspan="6" style="text-align: center;">
                    <button class="btn btn-sm" id="addTeacherVisit" style="margin: 10px;">
                        <i class="fas fa-plus"></i> إضافة زيارة جديدة
                    </button>
                </td>
            `;
            table.appendChild(addRow);

            document.getElementById('addTeacherVisit').addEventListener('click', function() {
                qualityReportData.teacherVisits.push({
                    teacher: '',
                    department: '',
                    date: '',
                    evaluation: 'ممتاز',
                    visitor: ''
                });
                renderTeacherVisitsReportTable();
            });

            // إذا لم تكن هناك زيارات، إضافة صف فارغ
            if (qualityReportData.teacherVisits.length === 0) {
                qualityReportData.teacherVisits.push({
                    teacher: '',
                    department: '',
                    date: '',
                    evaluation: 'ممتاز',
                    visitor: ''
                });
                renderTeacherVisitsReportTable();
            }
        }

        // عرض جدول الأداء في التقرير
        function renderPerformanceReportTable() {
            const table = document.getElementById('performanceReportTable');
            table.innerHTML = '';

            const departments = [
                'قسم الرياضيات',
                'قسم العلوم',
                'قسم اللغة العربية',
                'قسم اللغة الانجليزية',
                'قسم التربية الاسلامية',
                'قسم المواد الاجتماعية',
                'قسم المواد الاثرائية',
                'قسم التربية الرياضية',
                'قسم نظام فصل'
            ];

            departments.forEach((dept, index) => {
                const row = document.createElement('tr');
                const existingData = qualityReportData.performance.find(item => item.department === dept) || {};
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${dept}</td>
                    <td><input type="number" class="report-input" value="${existingData.total || ''}" min="0" data-department="${dept}" data-field="total"></td>
                    <td><input type="number" class="report-input" value="${existingData.excellent || ''}" min="0" data-department="${dept}" data-field="excellent"></td>
                    <td><input type="number" class="report-input" value="${existingData.veryGood || ''}" min="0" data-department="${dept}" data-field="veryGood"></td>
                    <td><input type="number" class="report-input" value="${existingData.good || ''}" min="0" data-department="${dept}" data-field="good"></td>
                    <td><input type="number" class="report-input" value="${existingData.fair || ''}" min="0" data-department="${dept}" data-field="fair"></td>
                `;
                table.appendChild(row);
            });

            // إضافة معالجي الأحداث
            table.querySelectorAll('input').forEach(element => {
                element.addEventListener('change', function() {
                    const department = this.getAttribute('data-department');
                    const field = this.getAttribute('data-field');
                    const value = parseInt(this.value) || 0;

                    let deptData = qualityReportData.performance.find(item => item.department === department);
                    if (!deptData) {
                        deptData = { department: department };
                        qualityReportData.performance.push(deptData);
                    }
                    deptData[field] = value;
                });
            });
        }

        // عرض جدول المعلمين المتميزين في التقرير
        function renderDistinguishedTeachersReportTable() {
            const table = document.getElementById('distinguishedTeachersReportTable');
            table.innerHTML = '';

            qualityReportData.distinguishedTeachers.forEach((teacher, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><input type="text" class="report-input" value="${teacher.name || ''}" data-index="${index}" data-field="name"></td>
                    <td><input type="text" class="report-input" value="${teacher.evaluation || ''}" data-index="${index}" data-field="evaluation"></td>
                    <td><textarea class="report-textarea" data-index="${index}" data-field="reasons">${teacher.reasons || ''}</textarea></td>
                    <td><input type="text" class="report-input" value="${teacher.department || ''}" data-index="${index}" data-field="department"></td>
                `;
                table.appendChild(row);
            });

            // إضافة معالجي الأحداث
            table.querySelectorAll('input, textarea').forEach(element => {
                element.addEventListener('change', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    const field = this.getAttribute('data-field');
                    const value = this.value;

                    if (!qualityReportData.distinguishedTeachers[index]) {
                        qualityReportData.distinguishedTeachers[index] = {};
                    }
                    qualityReportData.distinguishedTeachers[index][field] = value;
                });
            });

            // زر إضافة معلم متميز جديد
            const addRow = document.createElement('tr');
            addRow.innerHTML = `
                <td colspan="5" style="text-align: center;">
                    <button class="btn btn-sm" id="addDistinguishedTeacher" style="margin: 10px;">
                        <i class="fas fa-plus"></i> إضافة معلم متميز
                    </button>
                </td>
            `;
            table.appendChild(addRow);

            document.getElementById('addDistinguishedTeacher').addEventListener('click', function() {
                qualityReportData.distinguishedTeachers.push({
                    name: '',
                    evaluation: '',
                    reasons: '',
                    department: ''
                });
                renderDistinguishedTeachersReportTable();
            });

            if (qualityReportData.distinguishedTeachers.length === 0) {
                qualityReportData.distinguishedTeachers.push({
                    name: '',
                    evaluation: '',
                    reasons: '',
                    department: ''
                });
                renderDistinguishedTeachersReportTable();
            }
        }

        // عرض جدول المعلمين الأولى بالرعاية في التقرير
        function renderTeachersNeedCareReportTable() {
            const table = document.getElementById('teachersNeedCareReportTable');
            table.innerHTML = '';

            qualityReportData.teachersNeedCare.forEach((teacher, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><input type="text" class="report-input" value="${teacher.name || ''}" data-index="${index}" data-field="name"></td>
                    <td><input type="text" class="report-input" value="${teacher.evaluation || ''}" data-index="${index}" data-field="evaluation"></td>
                    <td><textarea class="report-textarea" data-index="${index}" data-field="reasons">${teacher.reasons || ''}</textarea></td>
                    <td><input type="text" class="report-input" value="${teacher.department || ''}" data-index="${index}" data-field="department"></td>
                `;
                table.appendChild(row);
            });

            // إضافة معالجي الأحداث
            table.querySelectorAll('input, textarea').forEach(element => {
                element.addEventListener('change', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    const field = this.getAttribute('data-field');
                    const value = this.value;

                    if (!qualityReportData.teachersNeedCare[index]) {
                        qualityReportData.teachersNeedCare[index] = {};
                    }
                    qualityReportData.teachersNeedCare[index][field] = value;
                });
            });

            // زر إضافة معلم يحتاج رعاية جديد
            const addRow = document.createElement('tr');
            addRow.innerHTML = `
                <td colspan="5" style="text-align: center;">
                    <button class="btn btn-sm" id="addTeacherNeedCare" style="margin: 10px;">
                        <i class="fas fa-plus"></i> إضافة معلم يحتاج رعاية
                    </button>
                </td>
            `;
            table.appendChild(addRow);

            document.getElementById('addTeacherNeedCare').addEventListener('click', function() {
                qualityReportData.teachersNeedCare.push({
                    name: '',
                    evaluation: '',
                    reasons: '',
                    department: ''
                });
                renderTeachersNeedCareReportTable();
            });

            if (qualityReportData.teachersNeedCare.length === 0) {
                qualityReportData.teachersNeedCare.push({
                    name: '',
                    evaluation: '',
                    reasons: '',
                    department: ''
                });
                renderTeachersNeedCareReportTable();
            }
        }

        // عرض جدول التقرير النوعي
        function renderQualityReportTable() {
            const table = document.getElementById('qualityReportTable');
            table.innerHTML = '';

            const departments = [
                'الرياضيات والعلوم',
                'اللغة العربية',
                'اللغة الانجليزية',
                'التربية الإسلامية',
                'المواد الاجتماعية',
                'المواد الاثرائية',
                'التربية الرياضية',
                'نظام الفصل'
            ];

            departments.forEach(dept => {
                const row = document.createElement('tr');
                const existingData = qualityReportData.qualityReport.find(item => item.department === dept) || {};
                
                row.innerHTML = `
                    <td>${dept}</td>
                    <td><textarea class="report-textarea" data-department="${dept}" data-field="strengths">${existingData.strengths || ''}</textarea></td>
                    <td><textarea class="report-textarea" data-department="${dept}" data-field="improvements">${existingData.improvements || ''}</textarea></td>
                `;
                table.appendChild(row);
            });

            // إضافة معالجي الأحداث
            table.querySelectorAll('textarea').forEach(element => {
                element.addEventListener('change', function() {
                    const department = this.getAttribute('data-department');
                    const field = this.getAttribute('data-field');
                    const value = this.value;

                    let deptData = qualityReportData.qualityReport.find(item => item.department === department);
                    if (!deptData) {
                        deptData = { department: department };
                        qualityReportData.qualityReport.push(deptData);
                    }
                    deptData[field] = value;
                });
            });
        }

        // تحميل التقرير كملف Word
        function downloadWordReport() {
            alert('سيتم تنزيل التقرير كملف Word. هذه الميزة قيد التطوير.');
            // تنفيذ إنشاء ملف Word هنا
        }

        // تحميل التقرير كملف PDF
        function downloadPdfReport() {
            alert('سيتم تنزيل التقرير كملف PDF. هذه الميزة قيد التطوير.');
            // تنفيذ إنشاء ملف PDF هنا
        }
    </script>
</body>
</html>
